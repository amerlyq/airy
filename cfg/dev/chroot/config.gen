#!/bin/bash -e
source ~/.shell/profile

# File must exist to start schroot
sudo touch /etc/schroot/schroot.conf


nm=lucid_i386
sudo tee "/etc/schroot/chroot.d/${nm}.conf" <<EOT
[$nm]
description=Build environment for $nm
personality=linux32
root-users=$USER
users=$USER
profile=default
type=directory
directory=/cryptfs/chroots/$nm
shell=/bin/bash
EOT


# Exists on Ubuntu, create manually on Arch
sudo tee /etc/networks <<EOT
# symbolic names for networks, see networks(5) for more information
link-local 169.254.0.0
EOT

# fl=/etc/schroot/default/fstab
# line='/cryptfs/_/cfg  /cryptfs/_/cfg  none    rw,bind         0       0'
# if grep -qsw '/cryptfs' "$fl"
# then sudo sed -i "/\\/cryptfs.*/s||$line|" "$fl"
# else sudo sed -i "/\\/home/a\\$line" "$fl"
# fi
