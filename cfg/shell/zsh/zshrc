# vim: ft=zsh

## Add completions and themes from custom place
# fpath=(~/.shell/zsh/completion.d $fpath ~/.shell/zsh/theme.d)

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

## workaround for handling TERM variable in multiple tmux sessions
# https://wiki.archlinux.org/index.php/Tmux#Correct_the_TERM_variable_according_to_terminal_type
#  properly by Nicholas Marriott
# if [[ -n ${TMUX} && -n ${commands[tmux]} ]]
# then case $(tmux showenv TERM 2>/dev/null) in
#     *256color) ;&
#     TERM=fbterm) TERM=screen-256color ;;
#     *) TERM=screen
# ;; esac; fi


### Opts ###
## Disable suspending on <C-s>, <C-q>
setopt noflowcontrol && stty stop '' -ixoff -ixon
## Lets files beginning with a . be matched without explicitly specifying the dot
setopt globdots


### User Cfg ###
# You will see errors in tty if one of them is not found:
source ~/.shell/env  # FIXME: must be already sourced through .zprofile/.zshenv, but is not!
source ~/.shell/zsh/amer-widgets.zsh
source ~/.shell/zsh/amer-key-mix.zsh
source ~/.shell/zsh/filetypes.zsh
# source ~/.shell/zsh/completion.zsh  # UNUSED
source ~/.shell/aliases


## Trap to sync zsh and ranger working directories.
# NOTE: '>!' is because of 'unsetopt CLOBBER' by 'prezto:directory'
function finish { printf "%s" "$PWD" >! "${TMPDIR:-/tmp}/ranger_cwdir"; }
trap finish EXIT
