#!/bin/bash -e
source ~/.shell/func.d/cfgsetup

### LINKS ###
link "$PWD" ~/.config/ranger


if cfgOpt c; then while read line
do rm -vf "${PWD}${line}"; done < "$PWD/.gitignore"; fi

if cfgOpt u; then
echo "USE: ranger --copy-config=all (Be Careful!), and see diff"; exit; fi


case "${SHELL?No}" in *bash) RC=~/.bashrc ;; *zsh) RC=~/.zshrc ;; esac
RC="$RC $HOME/.cache/zsh/.zshrc"
if ! grep -q '/tmp/aura/ranger_cwdir' $RC 2>/dev/null; then
    echo "===========================
    >>> Place in your shell's config ($RC):
    # To sync zsh and ranger working directories:"
    case "$SHELL" in *bash) echo '
    finish() { echo "$PWD" > '/tmp/aura/ranger_cwdir'; }
    trap finish EXIT
    ' ;; *zsh) echo '
    function finish { echo "$PWD" > '/tmp/aura/ranger_cwdir'; }
    trap finish EXIT
    ' ;; esac
    echo "-----------------"
fi
