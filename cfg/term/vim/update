#!/bin/bash -e
source ~/.shell/func.d/system
cd $(dirname $(readlink -m ${0}))

### PLUGINS ###
# BUG: returns non-zero errcode!
# FIXME: error on clean system, when NeoBundle is not installed yet
# DEV:TODO: use 'g:dein#install_log_filename' instead of 'redir!'
shvim() { $EDITOR -nesR -i NONE -u "$PWD/vimrc" \
    -c "set nomore|redir!>/dev/stderr" -c "$1" \
    -c "echo''|redir END|qall!" >/dev/null ||:; }

[[ $1 != -u ]] || shvim 'if dein#check_update()| call dein#update() |en'
shvim 'if dein#check_install()| call dein#install() |else| call dein#recache_runtimepath() |en'
shvim 'call dein#clear_state()'
