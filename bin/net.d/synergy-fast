#!/bin/bash
#   https://wiki.archlinux.org/index.php/synergy
# ALT: x2x, xrdp
#   http://raspberrypi.stackexchange.com/questions/4253/forward-mouse-and-keyboard-input-to-x-session

# SSH:
#   synergys -a localhost:24800
#   ssh -f -N -L 24800:server-hostname:24800

# --name screen-name | This option lets the client use a name
#                    | other  than  its  hostname for its screen.

source ~/.shenv
if [ $? -ne 0 ]; then exit 1; fi


CONF=~/.config/.synergy.conf

# if [ "$1" == "s" ]
if [ "$CURR_PROF" == "laptop" ]; then CLI=0; else CLI=1; fi

if [ "$1" == "d" ]; then MODE='-f'; else MODE='--daemon'; fi
if [ $CLI -eq 1 ]; then PR=synergyc; LARGS=$LAPT_IPL; else PR=synergys; LARGS="-c $CONF"; fi

LST=$(pgrep $PR)
if [ -n "$LST" ]; then kill -s SIGTERM $LST; fi
if [ "$1" == "k" ]; then exit; fi # kill only

# Set display to be able launch this by SSH
DISPLAY=:0.0 $PR --restart $MODE $LARGS

