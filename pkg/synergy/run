#!/bin/bash -e
source ~/.shell/profile

# SEE
#   https://wiki.archlinux.org/index.php/synergy
# ALT: x2x, xrdp
#   http://raspberrypi.stackexchange.com/questions/4253/forward-mouse-and-keyboard-input-to-x-session

# SSH:
#   synergys -a localhost:24800
#   ssh -f -N -L 24800:server-hostname:24800

# --name screen-name | This option lets the client use a name
#                    | other  than  its  hostname for its screen.

cfg=~/.cache/airy/synergy.conf

case "$CURR_PROF" in
laptop) pr=synergys; LARGS="-c $cfg" ;;
     *) pr=synergyc; LARGS=${LAPT_IPL?No lapt} ;;
esac

case "$1" in
-k) lst=$(pgrep "$pr") && kill -TERM $lst; exit ;;
-f) mode='-f' ;;
 *) mode='--daemon' ;;
esac

# Set display to be able launch this by SSH
DISPLAY=:0.0 $pr --restart $mode $LARGS
