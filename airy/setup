#!/bin/bash -eu
# NOTE: prolog must be completely independent
# BAD!RFC: dirty code duplication
#   => ALT: call ./run from ./setup to pre-initialize

cd "$(dirname "$(readlink -e "$0")")"
repo=$(git -C "$PWD" rev-parse --show-toplevel)
build=$repo/_build


### LINKS ###
[[ :$PATH: == *:$PWD/bin:* ]] || export PATH=$PWD/bin:$PATH
./ctl/cache-links -t "$build/bin" -q
linkcp -q ./pathes "$build/cfg/pathes"

linkcp -q "$build/bin" ~/.bin
linkcp -q "$build/cfg" ~/.config/airy
linkcp -q "$repo/cfg/shell/shell" ~/.shell  # REM

[[ :$PATH: == *:$HOME/.bin:* ]] || export PATH=~/.bin:$PATH
r.airy-cache-alias
